# 139 - NetBIOS

## RPCCLIENT

Si tenemos unas credenciales válidas o acceso a una _Null Session_ podemos enumerar información del sistema a través de "rpcclient"

```
#Null session
rpcclient -U -N "" <IP>

#Usuario válido
rpcclient -U "<usuario>" <IP>

#Comando que nos permite enumerar usuarios y limpiar el output
rpcclient -U "" <IP> -N -c 'enumdomusers' | grep -oP '\[.*?\]' | grep -v '0x' | tr -d '[]'

#Podríamos sacar toda la información de los usuarios con el siguiente:
for i in $(rpcclient -U "" <IP> -N -c 'enumdomusers' | grep -oP '\[.*?\]' | grep '0x' | tr -d '[]');do echo -e "\n** Para $i: ** \n"; rpcclient -U "" <IP> -N -c "queryuser $i"; done > rpcclient.txt

#Para grupos
for i in $(rpcclient -U "" <IP> -N -c 'enumdomgroups' | grep -oP '\[.*?\]' | grep '0x' | tr -d '[]');do echo -e "\n** Para $i: ** \n"; rpcclient -U "" <IP> -N -c "querygroup $i"; done > rpcgroups.txt
```

> \*Disclaimer: Este manual está realizado en base a lo que voy aprendiendo, si parte de la información que comparto no es correcta estaré encantado de que te pongas en contacto conmigo para hacérmelo saber y poder modificarlo.
