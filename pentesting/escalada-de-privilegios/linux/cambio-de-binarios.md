# Cambio de binarios (Linux)

## General

Cuando existe alguna tarea programada, o que se tengan permisos de ejecución y que sea ejecutada como un usuario con privilegios superiores a los que tenemos actualmente podemos aprovecharnos de ello.

En primer lugar necesitamos una carpeta del sistema a la que tengamos acceso de escritura para poder introducir nuestro binario, por ejemplo la carpeta "/tmp/"

```
export PATH=/tmp:$PATH
cd /tmp/
echo 'bin/sh' > cat
chmod +x cat
```

¿Qué estamos haciendo en este ejemplo? Dentro de la variable PATH la cual se usa para determinar donde se buscan los binarios cuando los llamamos introducimos en primer lugar la carpeta tmp.

Una vez hecho esto dentro de la carpeta tmp introducimos un falso binario "cat" que inicia una shell y le damos permisos de ejecución.

De esta manera cuando se ejecute la tarea con permisos de administrador que hace uso del binario cat nos aparecerá una shell ejecutada por el usuario que ejecuta dicha tarea.

## Python

Podemos también realizar siguiendo el mismo concepto un Library Hijacking, y hacer que un programa escrito en Python llame a una librería maliciosa.

Podemos saber el orden de prioridad con el siguiente comando:

```
python -c "import_sys; print(sys.path)
```

Podemos añadir información a este PATH:

```
export PYTHONPATH=/tmp
```

O también cuando estemos llamando a un archivo que llama a esa librería:

```
sudo PYTHONPATH=/tmp ejecutar.py
```



### Practicar

* Máquina "[Admirer](https://www.youtube.com/watch?v=hoQ6-wUldHg)" de HTB \[Acceso 11/02/2022]

> \*Disclaimer: Este manual está realizado en base a lo que voy aprendiendo, si parte de la información que comparto no es correcta estaré encantado de que te pongas en contacto conmigo para hacérmelo saber y poder modificarlo.
