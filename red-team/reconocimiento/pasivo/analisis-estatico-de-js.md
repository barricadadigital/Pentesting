---
description: Statical Analysis
---

# Análisis estático de JS

Es una forma semipasiva, ya que si bien podemos obtener los archivos ".js" directamente desde [WaybackMachine](wayback-machine.md) habrá que comprobar que dichos archivos siguen usándose en la web objetivo.

## Que obtenemos

1. URLs, Dominios...
2. Passwords, API keys...
3. Áreas vulnerables de código...
4. Versiones, frameworks...

## Obtener URLs con JS

Podemos utilizar WaybackMachine "[Waybackurls](https://github.com/tomnomnom/waybackurls)" o dorks de google por ejemplo, también se pueden utilizar crawlers de la página web o automatizar de alguna forma una obtención de todos los ficheros ".js" el objetivo sería obtener un listado de URLs con los ficheros .js que tenga la web.

Con waybackurl:

```
waybackurls https://webamirar | grep ".js$" | uniq | sort
```

Si queremos comprobar que siguen existiendo en el servidor se pueden utilizar las cabeceras de respuesta:

```
cat js_files_url_list.txt | parallel -j50 -q curl -w 'Status:%{http_code}\t Size:%{size_download}\t %{url_effective}\n' -o /dev/null -sk
```

O utilizar herramientas aparte [https://github.com/hakluke/hakcheckurl](https://github.com/hakluke/hakcheckurl)

## Hacer el código legible

En ocasiones el código puede estar minificado u ofuscado, en estos casos tenemos que conseguir un código que sea legible.

Para realizar el proceso contrario a minificar podemos utilizar herramientas cómo [JS BEautifier](https://github.com/beautify-web/js-beautify).

```
js-beautify archivomin.js
```

Si el código está ofuscado puede complicarse más y hay que probar distintas herramientas y métodos para hacerlo, en ocasiones incluso debe hacerse de forma manual:

* [JStillery](https://github.com/mindedsecurity/JStillery)
* [JSDetox](http://relentless-coding.org/projects/jsdetox)
* [JS-Beautifier](https://github.com/einars/js-beautify)
* [IlluminateJS](https://github.com/geeksonsecurity/illuminatejs)
* [JSNice](http://www.jsnice.org/)

## Identificar información

### URLs y Endpoints

Parte de la información a buscar pueden ser posibles URLs en el código Javascript:

Con la herramienta [relative-url-extractor](https://github.com/jobertabma/relative-url-extractor) de Jobert Abma podemos identificar rutas en archivos javascript, tanto de forma offline cómo indicándole la web del ".js". No es necesario desminificar.

```
ruby extract.rb https://loquesea.js
```

La herramienta [LinkFinder](https://github.com/GerbenJavado/LinkFinder) de Gerben Javado no solamente identifica URLs y _endpoints_ sino que además utiliza el jsbeautifier y puede también enumerar los archivos Javascript de un dominio.

```
python linkfinder.py -i https://example.com -d -o cli
```

### Información sensible (Contraseñas, API Keys...)

Se pueden utilizar búsquedas mediante expresiones reguladores aunque también tenemos herramientas que nos pueden facilitar.

[DumpsterDiver](https://github.com/securing/DumpsterDiver), [Repo-supervisor](https://github.com/auth0/repo-supervisor#repo-supervisor) y [truffleHog](https://github.com/dxa4481/truffleHog), buscan secretos en los códigos. Soportan búsquedas por entropia y por expresiones regulares.

### Código Vulnerable

Os recomiendo leer la URL de la que he obtenido la información que comparto abajo del todo, iré añadiendo información en esta sección.

* Uso de innerHTML, SetInnerHTML, eval...
* window.postMessage, window.addEventListener...
* window.localStorage, window.sessionStorage...

También tenemos herramientas que pueden buscar algunas vulnerabilidades dentro del código:

* [JSPrime ](https://github.com/dpnishant/jsprime)es una herramienta de análisis estático de código aunque está descontinuada.
* [ESLint ](https://github.com/eslint/eslint)es altamente customizable pudiendo arreglar [nuevas reglas](https://github.com/LewisArdern/eslint-plugin-angularjs-security-rules)

## Librerías y Frameworks vulnerables

Para poder identificar esto podemos utilizar por ejemplo el plugin de Firefox [Retire.js](https://retirejs.github.io/retire.js/) es una herramienta identifica este problema.

Realmente la herramienta se puede usar desde el navegador, mediante Burpsuite, cómo herramienta aparte...

Hay que tener en cuenta que cualquiera de estas herramientas puede reportar falsos positivos.

Información obtenida de [https://blog.appsecco.com/static-analysis-of-client-side-javascript-for-pen-testers-and-bug-bounty-hunters-f1cb1a5d5288](https://blog.appsecco.com/static-analysis-of-client-side-javascript-for-pen-testers-and-bug-bounty-hunters-f1cb1a5d5288)
