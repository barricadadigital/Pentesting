# Cookies y Tokens

## Cookies

### Cifrados débiles

Las cookies deben ir cifradas, pero en ocasiones podemos encontrarnos cifrados débiles que nos permiten ver información en claro. Por ejemplo un cifrado de cookie en base64 que nos permitiese ver usuario y contraseña almacenada en la propia cookie:

```
echo "YWRtaW46cGFzc3dvcmRzZWd1cmE=" | base64 -d
admin:passwordsegura
```

### Vulnerabilidades

Puede ser víctima dependiendo de diversos factores de:

* SQLI
* XSS
* CSRF
* ...

### Cierre de sesión no validado en el servidor

Puede ocurrir que la sesión no se valide en el lado del servidor, sólo en el lado del cliente. Para comprobar esto simplemente debemos loguearnos, hacernos con la cookie, pulsar en la opción de logout de la que disponga la web y añadir manualmente la cookie anterior. Si resulta que la Cookie sigue funcionando es que el servidor no valida dicha expiración tras pulsar logout, por lo que la Cookie podrá ser reutilizada durante el tiempo de vida que tenga.

## JWT

Los Jason Web Token son un tipo de Token que tienen una forma similar a la siguiente:

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
```

Podéis ver un poco más sobre los JWT y comprobar qué contienen con el addon de Burpsuite JWT [https://portswigger.net/bappstore/f923cbf91698420890354c1d8958fee6](https://portswigger.net/bappstore/f923cbf91698420890354c1d8958fee6) , también en la siguiente web [https://jwt.io/](https://jwt.io/).

### Crack/romper JWT

Podemos intentar buscar la clave con la que se firmo el Token si usó una clave débil con la siguiente herramienta:

{% embed url="https://github.com/x1sec/gojwtcrack" %}

## Auditar JWT

Además tenemos algunas otras herramientas que permiten realizar pentesting de los JWT

{% embed url="https://github.com/ticarpi/jwt_tool" %}
