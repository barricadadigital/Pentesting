# Crocodile

En este caso HTB ya quiere que comencemos a buscar en más de un sitio, mientras que en las máquinas anteriores han sido únicamente para mostrar una vulnerabilidad aquí necesitas la suma de varias para poder llegar a la flag que se busca.

## Enumeración

```
nmap -p- --open -n -T5 10.129.120.192

Starting Nmap 7.92 ( https://nmap.org ) at 2021-10-21 08:51 CEST
Stats: 0:00:30 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 22.94% done; ETC: 08:53 (0:01:41 remaining)
Nmap scan report for 10.129.120.192
Host is up (0.069s latency).
Not shown: 33555 filtered tcp ports (no-response), 31978 closed tcp ports (conn-refused)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT   STATE SERVICE
21/tcp open  ftp
80/tcp open  http

# Veamos versiones y scripts básicos

nmap -p21,80 -sC -sV -n -Pn 10.129.120.192

Starting Nmap 7.92 ( https://nmap.org ) at 2021-10-21 09:02 CEST
Nmap scan report for 10.129.120.192
Host is up (0.39s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| -rw-r--r--    1 ftp      ftp            33 Jun 08 10:58 allowed.userlist
|_-rw-r--r--    1 ftp      ftp            62 Apr 20  2021 allowed.userlist.passwd
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.10.15.87
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-title: Smash - Bootstrap Business Template
|_http-server-header: Apache/2.4.41 (Ubuntu)
Service Info: OS: Unix

```

Podemos ver que tenemos acceso tanto a un ftp como a un servidor apache en el puerto 80, es decir, un servidor web. Podemos comenzar con el FTP a ver si vemos algo interesante.

## FTP

Una de las primeras cosas que podemos probar con el FTP al igual que con SMB etc... Es una sesión anónima, así que vamos a por ello.

### Anonymous

```
ftp 10.129.120.192

Connected to 10.129.120.207.
220 (vsFTPd 3.0.3)
Name (10.129.120.207:shanks): anonymous
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp            33 Jun 08 10:58 allowed.userlist
-rw-r--r--    1 ftp      ftp            62 Apr 20  2021 allowed.userlist.passwd
226 Directory send OK.
ftp> get allowed.userlist
local: allowed.userlist remote: allowed.userlist
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for allowed.userlist (33 bytes).
226 Transfer complete.
33 bytes received in 0.00 secs (596.7882 kB/s)
ftp> get allowed.userlist.passwd
local: allowed.userlist.passwd remote: allowed.userlist.passwd
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for allowed.userlist.passwd (62 bytes).
226 Transfer complete.
62 bytes received in 0.00 secs (117.3389 kB/s)

```

Cómo podéis ver hemos podido acceder con una sesión anónima y acceder a dos archivos que hemos descargado.

```
bat allowed.userlist

───────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: allowed.userlist
───────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ aron
   2   │ pwnmeow
   3   │ egotisticalsw
   4   │ admin
───────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

bat allowed.userlist.passwd 

───────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: allowed.userlist.passwd
───────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ root
   2   │ Supersecretpassword1
   3   │ @BaASD&9032123sADS
   4   │ rKXM59ESxesUFHAd
───────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


```

Por lo que parece tenemos una lista de usuarios y contraseñas, pero aunque las pruebes una a una en el servidor ftp no parece que sirva para acceder a más recursos, por lo que puede que podamos utilizarla en el servidor web.

## Web

Para empezar echamos un ojo por encima, vemos el código fuente, entramos en algunos enlaces a ver si llegamos a algún sitio, pero cómo parece que no se encuentra nada vamos a ponernos manos a la obra con el fuzzing.

### Fuzzing web

```
gobuster dir -u http://10.129.120.192/ -w /usr/share/dirb/wordlists/common.txt -t 50

===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.129.120.192/
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/10/21 09:09:18 Starting gobuster in directory enumeration mode
===============================================================
/.htaccess            (Status: 403) [Size: 279]
/.htpasswd            (Status: 403) [Size: 279]
/assets               (Status: 301) [Size: 317] [--> http://10.129.120.192/assets/]
/.hta                 (Status: 403) [Size: 279]                                    
/css                  (Status: 301) [Size: 314] [--> http://10.129.120.192/css/]   
/dashboard            (Status: 301) [Size: 320] [--> http://10.129.120.192/dashboard/]
/fonts                (Status: 301) [Size: 316] [--> http://10.129.120.192/fonts/]    
/index.html           (Status: 200) [Size: 58565]                                     
/js                   (Status: 301) [Size: 313] [--> http://10.129.120.192/js/]       
/server-status        (Status: 403) [Size: 279]                                       

```

A mi personalmente me gusta más trabajar con gobuster que con dirbuster, pero es indiferente la herramienta que utilicéis. En esta ocasión no parece que encontremos nada de utilidad, podemos ir probando echando un ojo pero no parece que haya nada que nos interese.

Aquí es donde cobra importancia el hecho de seguir haciendo fuzzing, podemos probar otros diccionarios más grandes o podemos probar ciertas extensiones. Yo personalmente suelo utilizar las que tengo justo aquí debajo.

```
gobuster dir -u http://10.129.120.192/ -w /usr/share/dirb/wordlists/common.txt -x php,old,bak,html,htm,txt,"" -t 50

===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.129.120.192/
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              txt,,php,old,bak,html,htm
[+] Timeout:                 10s
===============================================================
2021/10/21 09:32:13 Starting gobuster in directory enumeration mode
===============================================================
/.hta.bak             (Status: 403) [Size: 279]
/.htaccess.php        (Status: 403) [Size: 279]
/.hta.html            (Status: 403) [Size: 279]
/.htaccess.old        (Status: 403) [Size: 279]
/.hta.htm             (Status: 403) [Size: 279]
/.htaccess.bak        (Status: 403) [Size: 279]
/.hta.txt             (Status: 403) [Size: 279]
/.htaccess            (Status: 403) [Size: 279]
/.hta.                (Status: 403) [Size: 279]
/.htaccess.html       (Status: 403) [Size: 279]
/.htpasswd.htm        (Status: 403) [Size: 279]
/.hta                 (Status: 403) [Size: 279]
/.htaccess.htm        (Status: 403) [Size: 279]
/.htpasswd.txt        (Status: 403) [Size: 279]
/.hta.php             (Status: 403) [Size: 279]
/.htaccess.txt        (Status: 403) [Size: 279]
/.htpasswd.           (Status: 403) [Size: 279]
/.hta.old             (Status: 403) [Size: 279]
/.htaccess.           (Status: 403) [Size: 279]
/.htpasswd.php        (Status: 403) [Size: 279]
/.htpasswd.old        (Status: 403) [Size: 279]
/.htpasswd            (Status: 403) [Size: 279]
/.htpasswd.bak        (Status: 403) [Size: 279]
/.htpasswd.html       (Status: 403) [Size: 279]
/assets               (Status: 301) [Size: 317] [--> http://10.129.120.192/assets/]
/config.php           (Status: 200) [Size: 0]                                      
/css                  (Status: 301) [Size: 314] [--> http://10.129.120.192/css/]   
/dashboard            (Status: 301) [Size: 320] [--> http://10.129.120.192/dashboard/]
/fonts                (Status: 301) [Size: 316] [--> http://10.129.120.192/fonts/]    
/index.html           (Status: 200) [Size: 58565]                                     
/index.html           (Status: 200) [Size: 58565]                                     
/js                   (Status: 301) [Size: 313] [--> http://10.129.120.192/js/]       
/login.php            (Status: 200) [Size: 1577]                                      
/logout.php           (Status: 302) [Size: 0] [--> login.php]                         
/server-status        (Status: 403) [Size: 279]                        
```

¡EUREKA! parece que encontramos alguna cosa más, entre ello tenemos el directorio "/login.php" en el que de hecho podemos probar las credenciales que obtuvimos en el FTP y tenemos la flag.
